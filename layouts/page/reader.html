{{ define "main" }}
<h1>Reader</h1>
<p class="muted">Browse all articles scored by Sieve. Filter, sort, and explore.</p>

<div class="reader-controls" id="reader-controls">
  <label>
    Source
    <select id="filter-source"><option value="">All sources</option></select>
  </label>
  <label id="topic-filter-label">
    Topic
    <select id="filter-topic"><option value="">All topics</option></select>
  </label>
  <label>
    Search
    <input type="search" id="filter-search" placeholder="Search titles...">
  </label>
</div>

<div class="reader-sort" id="reader-sort">
  <label class="sort-label">
    Sort by
    <select id="sort-field">
      <option value="date">Date</option>
      <option value="score">Overall Score</option>
      <option value="attention_economy">Attention Economy</option>
      <option value="data_sovereignty">Data Sovereignty</option>
      <option value="power_consolidation">Power Consolidation</option>
      <option value="coercion_cooperation">Coercion vs. Cooperation</option>
      <option value="fear_trust">Fear vs. Trust</option>
      <option value="democratization">Democratization</option>
      <option value="systemic_design">Systemic Design</option>
    </select>
  </label>
  <button id="sort-dir" class="sort-dir-btn">↓ Newest</button>
</div>

<details class="axiom-filter-wrap" id="axiom-filter">
  <summary class="muted">Filter by domain</summary>
  <div class="axiom-checkboxes">
    <label><input type="checkbox" value="attention_economy"> Attention Economy</label>
    <label><input type="checkbox" value="data_sovereignty"> Data Sovereignty</label>
    <label><input type="checkbox" value="power_consolidation"> Power Consolidation</label>
    <label><input type="checkbox" value="coercion_cooperation"> Coercion vs. Cooperation</label>
    <label><input type="checkbox" value="fear_trust"> Fear vs. Trust</label>
    <label><input type="checkbox" value="democratization"> Democratization</label>
    <label><input type="checkbox" value="systemic_design"> Systemic Design</label>
  </div>
  <p class="muted axiom-filter-hint">Articles must score &gt; 0 on all selected domains.</p>
</details>

<div class="reader-status" id="reader-status"></div>

<ul class="article-list" id="article-list">
  <li class="reader-loading">Loading articles</li>
</ul>

<div class="reader-pagination" id="reader-pagination"></div>

<!-- Static article list for search engine crawlers -->
<div id="static-articles">
  <h2>Top Scored Articles</h2>
  <p>{{ with .Site.Data.articles }}{{ .total_articles }}{{ end }} articles scored by Sieve across 7 domains: Attention Economy, Data Sovereignty, Power Consolidation, Coercion vs. Cooperation, Fear vs. Trust, Democratization, and Systemic Design.</p>
  {{ $sorted := sort .Site.Data.articles.articles "overall_score" "desc" }}
  {{ range first 50 $sorted }}
  <article class="static-article-item">
    <h3><a href="{{ .url }}" rel="noopener">{{ .title }}</a></h3>
    <div class="static-article-meta">
      <span>{{ .source }}</span>
      {{ with .published }} · <time datetime="{{ . }}">{{ . }}</time>{{ end }}
      · Score: {{ .overall_score }}
    </div>
    {{ with .summary }}<p>{{ . }}</p>{{ end }}
  </article>
  {{ end }}
</div>

<noscript>
  <p>The Reader requires JavaScript for interactive filtering and sorting.</p>
</noscript>
{{ end }}

{{ define "scripts" }}
<script src="/js/reader.js"></script>
{{ end }}
